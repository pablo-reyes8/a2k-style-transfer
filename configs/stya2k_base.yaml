experiment:
  name: StyA2KNet
  seed: 7
  output_dir: runs/stya2k
  checkpoint_dir: checkpoints
  sample_dir: samples_stya2k

model:
  device: cuda
  encoder:
    content_layers: ["relu4_1"]
    style_layers: ["relu1_1", "relu2_1", "relu3_1", "relu4_1", "relu5_1"]
  fusion:
    in_channels: 512
    key_dim: 128
    pool_hw: 8
    residual: true
  decoder:
    out_size: [252, 252]

loss:
  type: perceptual
  clamp_pred: true
  content_weights:
    relu4_1: 1.0
  style_weights:
    relu1_1: 1.0
    relu2_1: 1.0
    relu3_1: 1.0
    relu4_1: 1.0
    relu5_1: 1.0

data:
  batch_size: 32
  num_workers: 4
  pin_memory: true
  drop_last: true
  final_size: 252
  content:
    hub_id: coco_captions
    config: 2017
    split: train
    max_images: 10000
    random_resized_crop_scale: [0.5, 1.0]
    horizontal_flip: 0.5
  style:
    hub_id: huggan/wikiart
    config: full
    split: train
    max_images: 30000
    random_resized_crop_scale: [0.7, 1.0]
    horizontal_flip: 0.2

optimizer:
  name: adam
  lr: 0.0001
  betas: [0.9, 0.999]
  weight_decay: 0.0

training:
  epochs: 40
  amp_enabled: true
  amp_dtype: bf16
  grad_clip: 1.0
  log_every: 50
  sample_every: 1
  save_every: 5
  resume_from: null
